<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Management â€” CyberSOC Playbook</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/kql.css">
    <link rel="stylesheet" href="css/print.css">
</head>
<body>
    <a href="#main" class="skip-link">Skip to content</a>

    <!-- Top Bar -->
    <header class="topbar">
        <div class="topbar-logo">
            <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="2" y="2" width="28" height="28" rx="6" stroke="#06b6d4" stroke-width="2"/>
                <path d="M16 8v16M8 16h16" stroke="#06b6d4" stroke-width="2" stroke-linecap="round"/>
                <circle cx="16" cy="16" r="4" stroke="#a855f7" stroke-width="2"/>
                <circle cx="16" cy="16" r="8" stroke="#06b6d4" stroke-width="1" opacity="0.4"/>
            </svg>
            <span>Cyber<span class="logo-accent">SOC</span> Playbook</span>
        </div>

        <div class="topbar-search">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" placeholder="Search playbooks... (Ctrl+K)" aria-label="Search playbooks">
            <div class="search-results"></div>
        </div>

        <div class="topbar-actions">
            <button class="btn-topbar btn-print" aria-label="Print this page" title="Print">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
            </button>
            <button class="btn-topbar btn-menu" aria-label="Toggle menu">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
            </button>
        </div>
    </header>

    <!-- Sidebar -->
    <nav class="sidebar" aria-label="Main navigation">
        <div class="sidebar-section-title">Operations Center</div>
        <ul class="sidebar-nav">
            <li>
                <a href="index.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
                    <span class="nav-label">Dashboard</span>
                </a>
            </li>
        </ul>
        <div class="sidebar-section-title">Playbooks</div>
        <ul class="sidebar-nav">
            <li>
                <a href="threat-intelligence.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/></svg>
                    <span class="nav-label">Threat Intelligence</span>
                </a>
            </li>
            <li>
                <a href="protective-monitoring.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    <span class="nav-label">Protective Monitoring</span>
                </a>
            </li>
            <li>
                <a href="incident-management.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/><line x1="9" y1="12" x2="15" y2="12"/><line x1="9" y1="16" x2="13" y2="16"/></svg>
                    <span class="nav-label">Incident Management</span>
                </a>
            </li>
            <li>
                <a href="alert-triage.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
                    <span class="nav-label">Alert Triage</span>
                </a>
            </li>
            <li>
                <a href="incident-response.html">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                    <span class="nav-label">Incident Response</span>
                </a>
            </li>
            <li>
                <a href="vulnerability-management.html" class="active">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 8v4"/><path d="M12 16h.01"/></svg>
                    <span class="nav-label">Vulnerability Management</span>
                </a>
            </li>
        </ul>
        <div class="sidebar-toc"><div class="sidebar-section-title">On This Page</div><ul class="sidebar-toc-list"></ul></div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="main">
        <div class="page-header">
            <h1>
                <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 8v4"/><path d="M12 16h.01"/></svg>
                Vulnerability Management
            </h1>
            <p class="page-subtitle">TVM assessment, vulnerability exposure analysis, patch prioritization, risk scoring, remediation tracking, and software inventory management via Microsoft Defender for Endpoint.</p>
            <div class="page-meta">
                <span>
                    <svg viewBox="0 0 16 16" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="2" width="12" height="12" rx="2"/><line x1="2" y1="6" x2="14" y2="6"/><line x1="6" y1="2" x2="6" y2="6"/></svg>
                    Last Updated: 2025-02
                </span>
                <span>
                    <svg viewBox="0 0 16 16" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M8 14s6-3.5 6-8V3.5L8 1.5 2 3.5V6c0 4.5 6 8 6 8z"/></svg>
                    Microsoft Defender for Endpoint
                </span>
                <span>
                    <svg viewBox="0 0 16 16" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="6"/><polyline points="8 4 8 8 11 10"/></svg>
                    9 KQL Queries | 1 Decision Tree | 8 Procedures
                </span>
            </div>
        </div>

        <!-- ============================================================
             Section 1: MDE TVM Assessment
             ============================================================ -->
        <section class="section">
            <h2 id="tvm-assessment"><span class="section-number">1</span> MDE TVM Assessment</h2>
            <p>Microsoft Defender Vulnerability Management (TVM) provides continuous vulnerability discovery, intelligent prioritization, and remediation tracking across your endpoint fleet. Follow this procedure to perform a comprehensive TVM assessment.</p>

            <h3 id="tvm-assessment-procedure">TVM Assessment Procedure</h3>
            <ol class="procedure-steps">
                <li>Navigate to Microsoft 365 Defender portal &rarr; Vulnerability Management &rarr; Dashboard</li>
                <li>Review current Exposure Score (0-100, lower is better) and trending direction</li>
                <li>Review Device Exposure Distribution (Critical, High, Medium, Low)</li>
                <li>Check top security recommendations sorted by impact</li>
                <li>Review recently discovered vulnerabilities (CVEs) in the "Weaknesses" tab</li>
                <li>Identify devices with most critical vulnerabilities using "Exposed Devices"</li>
                <li>Generate vulnerability assessment report for management review</li>
            </ol>

            <div class="callout callout-info">
                <div class="callout-title">Key TVM Metrics</div>
                <p><strong>Exposure Score</strong> &mdash; Overall security risk posture (0-100). <strong>Secure Score for Devices</strong> &mdash; Configuration compliance percentage. <strong>Vulnerable Devices</strong> &mdash; Count of devices with known vulnerabilities. <strong>Critical Vulnerabilities</strong> &mdash; CVEs with CVSS 9.0+ requiring immediate attention.</p>
            </div>
        </section>

        <!-- ============================================================
             Section 2: Vulnerability Exposure KQL Queries
             ============================================================ -->
        <section class="section">
            <h2 id="vulnerability-queries"><span class="section-number">2</span> Vulnerability Exposure KQL Queries</h2>
            <p>The following KQL queries support vulnerability assessment and exposure analysis workflows. Run these in Microsoft 365 Defender Advanced Hunting to identify, prioritize, and track vulnerabilities across your endpoint fleet.</p>

            <!-- Query 1: All Critical Vulnerabilities on Exposed Devices -->
            <h3 id="kql-vm-critical">All Critical Vulnerabilities on Exposed Devices</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">All Critical Vulnerabilities on Exposed Devices</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-red">Critical</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Identifies all critical-severity CVEs across the fleet, ranked by the number of affected devices. Provides a prioritized list of the most impactful vulnerabilities requiring immediate remediation attention.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel == "Critical"
| summarize AffectedDevices = dcount(DeviceId),
            DeviceNames = make_set(DeviceName, 10),
            AffectedSoftware = make_set(SoftwareName)
    by CveId, VulnerabilitySeverityLevel
| sort by AffectedDevices desc
| take 25</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Top 25 critical CVEs ranked by number of affected devices. Includes CVE ID, severity level, device count, sample device names, and affected software names.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Weekly vulnerability review prioritization. Run this query at the start of each vulnerability management cycle to identify the highest-impact critical CVEs across your environment.</p>
                </div>
            </div>

            <!-- Query 2: Devices with Most Vulnerabilities -->
            <h3 id="kql-vm-most-vulnerable">Devices with Most Vulnerabilities</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Devices with Most Vulnerabilities</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-amber">Risk Ranking</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Ranks devices by a composite vulnerability risk score, weighting critical vulnerabilities more heavily than high or medium. Identifies the devices that pose the greatest aggregate risk to the environment.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareVulnerabilities
| summarize CriticalCount = countif(VulnerabilitySeverityLevel == "Critical"),
            HighCount = countif(VulnerabilitySeverityLevel == "High"),
            MediumCount = countif(VulnerabilitySeverityLevel == "Medium"),
            TotalVulns = count()
    by DeviceName, DeviceId
| extend RiskScore = (CriticalCount * 10) + (HighCount * 5) + (MediumCount * 1)
| sort by RiskScore desc
| take 20</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Top 20 devices ranked by composite vulnerability risk score. Includes device name, ID, counts by severity tier, total vulnerabilities, and the calculated risk score.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Identifying devices needing urgent patching. Use this to prioritize patch deployment to the most vulnerable endpoints first, particularly ahead of maintenance windows.</p>
                </div>
            </div>

            <!-- Query 3: Specific CVE Exposure Check -->
            <h3 id="kql-vm-cve-lookup">Specific CVE Exposure Check</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Specific CVE Exposure Check</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-red">CVE Lookup</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Checks the entire fleet for exposure to a specific CVE, joining vulnerability data with device information for full context. Replace the target CVE variable with the CVE ID you are investigating.</p>
                </div>
<pre><code class="language-kql">let targetCVE = "CVE-2024-12345";
DeviceTvmSoftwareVulnerabilities
| where CveId == targetCVE
| join kind=leftouter (
    DeviceInfo
    | where Timestamp > ago(1d)
    | summarize arg_max(Timestamp, *) by DeviceId
) on DeviceId
| project DeviceName, OSPlatform, OSVersion, SoftwareName,
         SoftwareVersion, VulnerabilitySeverityLevel, MachineGroup,
         PublicIP, LoggedOnUsers
| sort by DeviceName asc</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>All devices affected by the specified CVE with enriched context: device name, OS platform and version, vulnerable software and version, severity, machine group, public IP, and logged-on users.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>When a new critical CVE is published and you need to assess exposure. Run this immediately upon receiving a vulnerability advisory to determine your organization's attack surface for that specific CVE.</p>
                </div>
            </div>

            <!-- Query 4: Vulnerable Software Inventory -->
            <h3 id="kql-vm-software-vulns">Vulnerable Software Inventory</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Vulnerable Software Inventory</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-purple">Software Risk</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Correlates software vulnerability data with the software inventory to identify which software titles and versions carry the most vulnerabilities and affect the most devices across the fleet.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareVulnerabilities
| join kind=inner (
    DeviceTvmSoftwareInventory
    | summarize DeviceCount = dcount(DeviceId) by SoftwareName, SoftwareVersion
) on SoftwareName
| summarize VulnCount = dcount(CveId),
            CriticalVulns = dcountif(CveId, VulnerabilitySeverityLevel == "Critical"),
            DevicesAffected = dcount(DeviceId)
    by SoftwareName, SoftwareVersion
| sort by CriticalVulns desc, VulnCount desc
| take 30</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Software ranked by vulnerability count and critical vulnerability count. Includes software name, version, total vulnerabilities, critical vulnerabilities, and the number of affected devices.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Identifying software that poses the highest risk across the fleet. Use this during monthly vulnerability reviews to recommend software upgrades, replacements, or removal of high-risk applications.</p>
                </div>
            </div>

            <!-- Query 5: End-of-Life Software Detection -->
            <h3 id="kql-vm-eol">End-of-Life Software Detection</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">End-of-Life Software Detection</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareInventory</span>
                        <span class="badge badge-red">EOL Risk</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Detects all software that has reached or is approaching end-of-life/end-of-support status. End-of-life software no longer receives security patches and represents a significant ongoing vulnerability risk.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareInventory
| where EndOfSupportStatus != "None" and EndOfSupportStatus != ""
| summarize DeviceCount = dcount(DeviceId),
            Devices = make_set(DeviceName, 10),
            Versions = make_set(SoftwareVersion)
    by SoftwareName, EndOfSupportStatus, EndOfSupportDate
| sort by DeviceCount desc</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>All end-of-life software with device counts, sample device names, software versions, EOL status, and the end-of-support date. Sorted by the number of affected devices.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Monthly review to identify unsupported software requiring migration. EOL software should be flagged for replacement planning as it will not receive future security updates from the vendor.</p>
                </div>
            </div>

            <!-- Query 6: Vulnerability Age Analysis -->
            <h3 id="kql-vm-vuln-age">Vulnerability Age Analysis</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Vulnerability Age Analysis</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-amber">Remediation Velocity</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Calculates the average and maximum age of unpatched critical and high severity vulnerabilities. Provides a key metric for tracking remediation velocity and identifying stale vulnerabilities that have remained unpatched for too long.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel in ("Critical", "High")
| extend VulnAge = datetime_diff('day', now(), todatetime(CvePublishedDate))
| summarize AvgAge = avg(VulnAge),
            MaxAge = max(VulnAge),
            VulnCount = count()
    by VulnerabilitySeverityLevel
| extend AvgAgeDays = round(AvgAge, 0), MaxAgeDays = round(MaxAge, 0)
| project VulnerabilitySeverityLevel, VulnCount, AvgAgeDays, MaxAgeDays</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Average and maximum age of unpatched vulnerabilities grouped by severity level. Shows the count of open vulnerabilities, average days since CVE publication, and the oldest unpatched vulnerability age.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Tracking remediation velocity and identifying stale vulnerabilities. Use this in management reporting to demonstrate patching performance and highlight aging vulnerabilities that need escalation.</p>
                </div>
            </div>

            <!-- Query 7: Devices Missing Security Updates -->
            <h3 id="kql-vm-missing-updates">Devices Missing Security Updates</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Devices Missing Security Updates</span>
                        <span class="badge badge-cyan">DeviceTvmSecureConfigurationAssessment</span>
                        <span class="badge badge-red">Non-Compliant</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Identifies devices that are not compliant with security update configuration assessments. Focuses on patch-related configuration IDs to surface devices where patch deployment may be failing or stalled.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSecureConfigurationAssessment
| where ConfigurationId has "scid-91"
| where IsCompliant == 0
| where IsApplicable == 1
| summarize NonCompliantCount = count()
    by DeviceName, ConfigurationId, ConfigurationName
| sort by NonCompliantCount desc
| take 30</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Devices not compliant with security update configurations. Shows device name, configuration ID, configuration name, and the count of non-compliant assessments.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Identifying devices with patch deployment failures. Run this after patch deployment windows to verify compliance and identify devices that need manual intervention or troubleshooting.</p>
                </div>
            </div>

            <!-- Query 8: Browser Extension Risk Assessment -->
            <h3 id="kql-vm-browser-ext">Browser Extension Risk Assessment</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Browser Extension Risk Assessment</span>
                        <span class="badge badge-cyan">DeviceTvmBrowserExtensions</span>
                        <span class="badge badge-purple">Extension Audit</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Audits browser extensions installed across the fleet, identifying the most prevalent extensions and the browsers they are installed on. Helps detect potentially risky, unauthorized, or data-exfiltration-capable extensions.</p>
                </div>
<pre><code class="language-kql">DeviceTvmBrowserExtensions
| summarize DeviceCount = dcount(DeviceId),
            BrowserTypes = make_set(BrowserName)
    by ExtensionName, ExtensionId, ExtensionVersion
| where DeviceCount > 5
| sort by DeviceCount desc
| take 30</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Most prevalent browser extensions across the fleet. Includes extension name, ID, version, device count, and the browsers where the extension is installed.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Identifying potentially risky or unauthorized browser extensions. Run this monthly to audit the extension landscape and flag unknown or unapproved extensions for security review.</p>
                </div>
            </div>

            <!-- Query 9: Remediation Progress Tracking -->
            <h3 id="kql-vm-remediation-progress">Remediation Progress Tracking</h3>
            <div class="kql-block">
                <div class="kql-header">
                    <div class="kql-meta">
                        <span class="kql-title">Remediation Progress Tracking</span>
                        <span class="badge badge-cyan">DeviceTvmSoftwareVulnerabilities</span>
                        <span class="badge badge-green">Reporting</span>
                    </div>
                    <button class="btn-copy" aria-label="Copy KQL query">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <div class="kql-description">
                    <p>Generates a current-state vulnerability posture snapshot summarizing critical and high vulnerabilities, affected devices, and unique CVE count. Designed for weekly management reporting and dashboarding.</p>
                </div>
<pre><code class="language-kql">DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel in ("Critical", "High")
| summarize
    TotalVulns = count(),
    CriticalVulns = countif(VulnerabilitySeverityLevel == "Critical"),
    HighVulns = countif(VulnerabilitySeverityLevel == "High"),
    AffectedDevices = dcount(DeviceId),
    UniqueCVEs = dcount(CveId)
| extend Summary = strcat("Total: ", TotalVulns, " vulns (", CriticalVulns, " Critical, ", HighVulns, " High) across ", AffectedDevices, " devices")</code></pre>
                <div class="kql-output">
                    <h5>Expected Output</h5>
                    <p>Current vulnerability posture snapshot with total vulnerability count, critical and high breakdowns, number of affected devices, unique CVE count, and a summary string for reporting.</p>
                </div>
                <div class="kql-when">
                    <h5>When to Use</h5>
                    <p>Weekly management reporting on vulnerability status. Use this to track week-over-week progress on vulnerability remediation and provide leadership with a concise posture summary.</p>
                </div>
            </div>
        </section>

        <!-- ============================================================
             Section 3: Patch Prioritization
             ============================================================ -->
        <section class="section">
            <h2 id="patch-priority"><span class="section-number">3</span> Patch Prioritization</h2>
            <p>Follow this decision tree to determine the appropriate patch priority and remediation timeline for each newly identified vulnerability. This ensures consistent, risk-based prioritization across the team.</p>

            <ul class="decision-tree">
                <li>
                    <div class="dt-node dt-question">New Vulnerability Identified &mdash; Begin Prioritization</div>
                    <ul>
                        <li>
                            <div class="dt-node dt-question">Is the vulnerability actively exploited in the wild (KEV list / vendor advisory)?</div>
                            <ul>
                                <li>
                                    <div class="dt-node dt-yes dt-action"><strong>CRITICAL priority:</strong> Patch within 24-48 hours. Activate emergency change process. Notify security leadership immediately.</div>
                                </li>
                                <li>
                                    <div class="dt-node dt-no">Continue</div>
                                    <ul>
                                        <li>
                                            <div class="dt-node dt-question">Is there a public exploit available (Exploit-DB, GitHub)?</div>
                                            <ul>
                                                <li>
                                                    <div class="dt-node dt-yes dt-action"><strong>HIGH priority:</strong> Patch within 7 days. Schedule priority deployment in next available maintenance window.</div>
                                                </li>
                                                <li>
                                                    <div class="dt-node dt-no">Continue</div>
                                                    <ul>
                                                        <li>
                                                            <div class="dt-node dt-question">Is the CVSS score &ge; 9.0?</div>
                                                            <ul>
                                                                <li>
                                                                    <div class="dt-node dt-yes dt-action"><strong>HIGH priority:</strong> Patch within 14 days. Include in next scheduled patch cycle.</div>
                                                                </li>
                                                                <li>
                                                                    <div class="dt-node dt-no">Continue</div>
                                                                    <ul>
                                                                        <li>
                                                                            <div class="dt-node dt-question">Is the affected asset internet-facing or business-critical?</div>
                                                                            <ul>
                                                                                <li>
                                                                                    <div class="dt-node dt-yes dt-escalate"><strong>Increase priority by one level.</strong> Internet-facing and business-critical assets have higher exposure and impact.</div>
                                                                                </li>
                                                                                <li>
                                                                                    <div class="dt-node dt-no">Continue to CVSS-based prioritization</div>
                                                                                    <ul>
                                                                                        <li>
                                                                                            <div class="dt-node dt-question">Apply CVSS-based remediation timeline:</div>
                                                                                            <ul>
                                                                                                <li>
                                                                                                    <div class="dt-node dt-action"><strong>CVSS 7.0-8.9 &mdash; MEDIUM:</strong> Patch within 30 days via standard patch cycle.</div>
                                                                                                </li>
                                                                                                <li>
                                                                                                    <div class="dt-node dt-action"><strong>CVSS 4.0-6.9 &mdash; LOW:</strong> Patch within 90 days in regular maintenance.</div>
                                                                                                </li>
                                                                                                <li>
                                                                                                    <div class="dt-node dt-action"><strong>CVSS 0.1-3.9 &mdash; MINIMAL:</strong> Patch in next available maintenance window.</div>
                                                                                                </li>
                                                                                            </ul>
                                                                                        </li>
                                                                                    </ul>
                                                                                </li>
                                                                            </ul>
                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>

            <div class="callout callout-info">
                <div class="callout-title">Beyond CVSS</div>
                <p>Effective patch prioritization considers more than just CVSS scores. Factor in: asset criticality, network exposure, compensating controls, exploit maturity, and whether the vulnerability is being actively exploited. Microsoft's security recommendations in TVM already incorporate many of these factors.</p>
            </div>
        </section>

        <!-- ============================================================
             Section 4: Risk Scoring and Classification
             ============================================================ -->
        <section class="section">
            <h2 id="risk-scoring"><span class="section-number">4</span> Risk Scoring and Classification</h2>
            <p>Use this composite risk scoring model to calculate a consistent, weighted risk score for each vulnerability. The model considers multiple factors beyond CVSS to provide a more accurate representation of actual risk to the organization.</p>

            <h3 id="risk-scoring-model">Risk Scoring Model</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Factor</th>
                            <th>Weight</th>
                            <th><span class="badge badge-red">Critical (4)</span></th>
                            <th><span class="badge badge-amber">High (3)</span></th>
                            <th><span class="badge badge-blue">Medium (2)</span></th>
                            <th><span class="badge badge-muted">Low (1)</span></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>CVSS Base Score</strong></td>
                            <td>30%</td>
                            <td>9.0-10.0</td>
                            <td>7.0-8.9</td>
                            <td>4.0-6.9</td>
                            <td>0.1-3.9</td>
                        </tr>
                        <tr>
                            <td><strong>Exploit Availability</strong></td>
                            <td>25%</td>
                            <td>Active exploitation</td>
                            <td>Public exploit</td>
                            <td>PoC available</td>
                            <td>No known exploit</td>
                        </tr>
                        <tr>
                            <td><strong>Asset Criticality</strong></td>
                            <td>25%</td>
                            <td>Domain controllers, key servers</td>
                            <td>Department servers</td>
                            <td>Standard workstations</td>
                            <td>Test/dev systems</td>
                        </tr>
                        <tr>
                            <td><strong>Network Exposure</strong></td>
                            <td>20%</td>
                            <td>Internet-facing</td>
                            <td>DMZ / accessible from multiple zones</td>
                            <td>Internal only</td>
                            <td>Isolated network</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 id="risk-classification-matrix">Risk Classification Matrix</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Risk Level</th>
                            <th>Composite Score</th>
                            <th>SLA</th>
                            <th>Approval for Exception</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="row-critical">
                            <td><span class="badge badge-red">Critical</span></td>
                            <td><strong>3.5-4.0</strong></td>
                            <td><strong>48 hours</strong></td>
                            <td>CISO only</td>
                        </tr>
                        <tr class="row-high">
                            <td><span class="badge badge-amber">High</span></td>
                            <td><strong>2.5-3.4</strong></td>
                            <td><strong>7 days</strong></td>
                            <td>Security Manager</td>
                        </tr>
                        <tr class="row-medium">
                            <td><span class="badge badge-blue">Medium</span></td>
                            <td><strong>1.5-2.4</strong></td>
                            <td><strong>30 days</strong></td>
                            <td>Team Lead</td>
                        </tr>
                        <tr class="row-low">
                            <td><span class="badge badge-muted">Low</span></td>
                            <td><strong>1.0-1.4</strong></td>
                            <td><strong>90 days</strong></td>
                            <td>Analyst</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ============================================================
             Section 5: Remediation Tracking
             ============================================================ -->
        <section class="section">
            <h2 id="remediation"><span class="section-number">5</span> Remediation Tracking</h2>
            <p>A structured remediation workflow ensures vulnerabilities progress from identification through to verified resolution. Follow this end-to-end process for each vulnerability or batch of vulnerabilities identified.</p>

            <h3 id="remediation-workflow">Remediation Workflow</h3>
            <ol class="procedure-steps">
                <li>Vulnerability identified via TVM or scanning</li>
                <li>Risk assessed and prioritized using scoring model</li>
                <li>Remediation ticket created with SLA based on priority</li>
                <li>Ticket assigned to responsible team (IT Ops, App Team, etc.)</li>
                <li>Patch/fix applied per change management process</li>
                <li>Verification scan performed to confirm remediation</li>
                <li>Ticket closed with evidence of remediation</li>
            </ol>

            <h3 id="dashboard-metrics">Dashboard Metrics</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Description</th>
                            <th>Target</th>
                            <th>RAG Threshold</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Open Critical Vulns</strong></td>
                            <td>Count of unpatched critical CVEs</td>
                            <td>0</td>
                            <td><span class="badge badge-red">Red: &gt;5</span> <span class="badge badge-amber">Amber: 1-5</span> <span class="badge badge-green">Green: 0</span></td>
                        </tr>
                        <tr>
                            <td><strong>Open High Vulns</strong></td>
                            <td>Count of unpatched high CVEs</td>
                            <td>&lt;10</td>
                            <td><span class="badge badge-red">Red: &gt;25</span> <span class="badge badge-amber">Amber: 10-25</span> <span class="badge badge-green">Green: &lt;10</span></td>
                        </tr>
                        <tr>
                            <td><strong>Mean Time to Remediate (Critical)</strong></td>
                            <td>Average days from discovery to patch</td>
                            <td>&lt;2 days</td>
                            <td><span class="badge badge-red">Red: &gt;7</span> <span class="badge badge-amber">Amber: 2-7</span> <span class="badge badge-green">Green: &lt;2</span></td>
                        </tr>
                        <tr>
                            <td><strong>Mean Time to Remediate (High)</strong></td>
                            <td>Average days from discovery to patch</td>
                            <td>&lt;7 days</td>
                            <td><span class="badge badge-red">Red: &gt;14</span> <span class="badge badge-amber">Amber: 7-14</span> <span class="badge badge-green">Green: &lt;7</span></td>
                        </tr>
                        <tr>
                            <td><strong>SLA Compliance Rate</strong></td>
                            <td>% of vulns patched within SLA</td>
                            <td>&gt;95%</td>
                            <td><span class="badge badge-red">Red: &lt;80%</span> <span class="badge badge-amber">Amber: 80-95%</span> <span class="badge badge-green">Green: &gt;95%</span></td>
                        </tr>
                        <tr>
                            <td><strong>Vulnerability Recurrence</strong></td>
                            <td>Vulns that reappear after remediation</td>
                            <td>&lt;5%</td>
                            <td><span class="badge badge-red">Red: &gt;15%</span> <span class="badge badge-amber">Amber: 5-15%</span> <span class="badge badge-green">Green: &lt;5%</span></td>
                        </tr>
                        <tr>
                            <td><strong>Scan Coverage</strong></td>
                            <td>% of assets scanned by TVM</td>
                            <td>&gt;98%</td>
                            <td><span class="badge badge-red">Red: &lt;90%</span> <span class="badge badge-amber">Amber: 90-98%</span> <span class="badge badge-green">Green: &gt;98%</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ============================================================
             Section 6: Exception and Risk Acceptance
             ============================================================ -->
        <section class="section">
            <h2 id="exceptions"><span class="section-number">6</span> Exception and Risk Acceptance</h2>
            <p>When a vulnerability cannot be remediated within its SLA due to business, technical, or operational constraints, a formal risk acceptance process must be followed. All exceptions require documented justification, compensating controls, and appropriate approval authority.</p>

            <h3 id="risk-acceptance-form">Risk Acceptance Form</h3>
            <div class="card">
                <div class="kql-description">
                    <p>Complete the following template for every vulnerability exception request. All fields are mandatory.</p>
                </div>
<pre><code>EXCEPTION ID:           [EXC-YYYY-NNNN]
VULNERABILITY:          [CVE ID and description]
AFFECTED ASSETS:        [Device names/count]
BUSINESS JUSTIFICATION: [Why the vulnerability cannot be remediated]
COMPENSATING CONTROLS:  [Controls mitigating the risk]
RISK LEVEL:             [Critical/High/Medium/Low]
REQUESTED DURATION:     [Days/months]
REQUESTED BY:           [Name and role]
APPROVED BY:            [Must meet authority level per table below]
REVIEW DATE:            [Mandatory review date]</code></pre>
            </div>

            <h3 id="approval-authority">Approval Authority</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Risk Level</th>
                            <th>Approval Authority</th>
                            <th>Maximum Duration</th>
                            <th>Review Frequency</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="row-critical">
                            <td><span class="badge badge-red">Critical</span></td>
                            <td><strong>CISO</strong></td>
                            <td>30 days</td>
                            <td>Every 2 weeks</td>
                        </tr>
                        <tr class="row-high">
                            <td><span class="badge badge-amber">High</span></td>
                            <td><strong>Security Manager</strong></td>
                            <td>90 days</td>
                            <td>Monthly</td>
                        </tr>
                        <tr class="row-medium">
                            <td><span class="badge badge-blue">Medium</span></td>
                            <td><strong>Team Lead</strong></td>
                            <td>180 days</td>
                            <td>Quarterly</td>
                        </tr>
                        <tr class="row-low">
                            <td><span class="badge badge-muted">Low</span></td>
                            <td><strong>Senior Analyst</strong></td>
                            <td>365 days</td>
                            <td>Semi-annually</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 id="exception-process-checklist">Exception Process Checklist</h3>
            <div class="collapsible expanded">
                <div class="collapsible-header">
                    <svg class="collapsible-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                    <span class="collapsible-title">Exception Process Checklist</span>
                    <span class="collapsible-badge"><span class="badge badge-amber">Required</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-body">
                        <div class="checklist-section" data-checklist-id="exception-process">
                            <div class="checklist-progress">
                                <div class="checklist-progress-bar">
                                    <div class="checklist-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="checklist-progress-text">0 / 7</span>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-1">
                                <label for="ep-1">Document complete business justification for exception</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-2">
                                <label for="ep-2">Identify and implement compensating controls</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-3">
                                <label for="ep-3">Obtain approval from appropriate authority level</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-4">
                                <label for="ep-4">Record exception in risk register</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-5">
                                <label for="ep-5">Set calendar reminder for review date</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-6">
                                <label for="ep-6">Monitor compensating control effectiveness</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="ep-7">
                                <label for="ep-7">Re-assess at expiration &mdash; renew, remediate, or close</label>
                            </div>
                            <button class="btn-reset-checklist" data-checklist-id="exception-process">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
                                Reset Checklist
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="callout callout-warning">
                <div class="callout-title">Exception Governance</div>
                <p>All exceptions must have compensating controls documented. Exceptions without compensating controls require CISO approval regardless of risk level. Expired exceptions are automatically escalated.</p>
            </div>
        </section>

        <!-- ============================================================
             Section 7: Software Inventory Management
             ============================================================ -->
        <section class="section">
            <h2 id="software-inventory"><span class="section-number">7</span> Software Inventory Management</h2>
            <p>Maintaining an accurate software inventory is essential for vulnerability management. TVM provides continuous discovery of software installed across the fleet, enabling identification of unauthorized, outdated, or end-of-life applications.</p>

            <h3 id="software-inventory-procedure">Software Inventory Procedure</h3>
            <ol class="procedure-steps">
                <li>Access TVM &rarr; Software Inventory in Microsoft 365 Defender</li>
                <li>Review software catalog for unauthorized or unexpected applications</li>
                <li>Cross-reference with approved software list (CMDB)</li>
                <li>Flag unauthorized software for removal or approval review</li>
                <li>Identify end-of-life software for migration planning</li>
                <li>Track software version distribution to identify outdated installations</li>
                <li>Generate software inventory report for compliance</li>
            </ol>

            <h3 id="shadow-it">Shadow IT Detection</h3>

            <div class="callout callout-warning">
                <div class="callout-title">Shadow IT Risk</div>
                <p>Unauthorized software may introduce unpatched vulnerabilities, bypass security controls, or provide attack vectors. Use TVM software inventory to detect and address shadow IT installations.</p>
            </div>

            <div class="collapsible expanded">
                <div class="collapsible-header">
                    <svg class="collapsible-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                    <span class="collapsible-title">Shadow IT Review Checklist</span>
                    <span class="collapsible-badge"><span class="badge badge-amber">Monthly</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-body">
                        <div class="checklist-section" data-checklist-id="shadow-it-review">
                            <div class="checklist-progress">
                                <div class="checklist-progress-bar">
                                    <div class="checklist-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="checklist-progress-text">0 / 7</span>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-1">
                                <label for="si-1">Export current software inventory from TVM</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-2">
                                <label for="si-2">Compare against approved software baseline</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-3">
                                <label for="si-3">Identify new/unauthorized applications</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-4">
                                <label for="si-4">Investigate purpose and owner of unauthorized software</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-5">
                                <label for="si-5">Determine risk level of each unauthorized application</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-6">
                                <label for="si-6">Create removal or approval tickets as appropriate</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="si-7">
                                <label for="si-7">Update approved software baseline</label>
                            </div>
                            <button class="btn-reset-checklist" data-checklist-id="shadow-it-review">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
                                Reset Checklist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================================
             Section 8: Security Recommendations Review
             ============================================================ -->
        <section class="section">
            <h2 id="security-recommendations"><span class="section-number">8</span> Security Recommendations Review</h2>
            <p>Microsoft Defender TVM generates actionable security recommendations based on the configuration and vulnerability state of your fleet. Regularly reviewing and implementing these recommendations reduces your overall exposure score and hardens the environment.</p>

            <h3 id="recommendations-procedure">Recommendations Review Procedure</h3>
            <ol class="procedure-steps">
                <li>Navigate to TVM &rarr; Security Recommendations</li>
                <li>Sort by "Exposure Impact" to prioritize high-impact items</li>
                <li>Review recommendation details: affected devices, remediation steps, expected impact</li>
                <li>Categorize: Security Controls, OS Configuration, Application Configuration</li>
                <li>Assign remediation owners based on recommendation type</li>
                <li>Create implementation tickets with SLA aligned to priority</li>
                <li>Track implementation progress weekly</li>
                <li>Mark recommendations as completed in TVM after implementation</li>
            </ol>

            <h3 id="recommendation-priority">Recommendation Priority</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Examples</th>
                            <th>Default Priority</th>
                            <th>Owner</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Security Controls</strong></td>
                            <td>Enable ASR rules, Configure firewall, Enable credential guard</td>
                            <td><span class="badge badge-red">High</span></td>
                            <td>Security Engineering</td>
                        </tr>
                        <tr>
                            <td><strong>OS Configuration</strong></td>
                            <td>Enable secure boot, Configure audit policies, Disable SMBv1</td>
                            <td><span class="badge badge-amber">Medium</span></td>
                            <td>IT Operations</td>
                        </tr>
                        <tr>
                            <td><strong>Application Configuration</strong></td>
                            <td>Update browser settings, Configure Office macros, Java settings</td>
                            <td><span class="badge badge-amber">Medium</span></td>
                            <td>Desktop Engineering</td>
                        </tr>
                        <tr>
                            <td><strong>Software Updates</strong></td>
                            <td>OS patches, Application updates, Driver updates</td>
                            <td><span class="badge badge-blue">Varies by CVSS</span></td>
                            <td>Patch Management</td>
                        </tr>
                        <tr>
                            <td><strong>Hardware</strong></td>
                            <td>TPM enablement, Firmware updates</td>
                            <td><span class="badge badge-muted">Low</span></td>
                            <td>Hardware Team</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 id="recommendations-review-checklist">Recommendations Review Checklist</h3>
            <div class="collapsible expanded">
                <div class="collapsible-header">
                    <svg class="collapsible-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                    <span class="collapsible-title">Weekly Recommendations Review</span>
                    <span class="collapsible-badge"><span class="badge badge-green">Weekly</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-body">
                        <div class="checklist-section" data-checklist-id="recommendations-review">
                            <div class="checklist-progress">
                                <div class="checklist-progress-bar">
                                    <div class="checklist-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="checklist-progress-text">0 / 7</span>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-1">
                                <label for="rr-1">Review new security recommendations weekly</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-2">
                                <label for="rr-2">Prioritize recommendations by exposure impact</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-3">
                                <label for="rr-3">Assign owners to top 10 unaddressed recommendations</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-4">
                                <label for="rr-4">Track implementation progress</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-5">
                                <label for="rr-5">Close completed recommendations in TVM</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-6">
                                <label for="rr-6">Report recommendation compliance to management monthly</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="rr-7">
                                <label for="rr-7">Escalate stalled recommendations after 30 days</label>
                            </div>
                            <button class="btn-reset-checklist" data-checklist-id="recommendations-review">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
                                Reset Checklist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script src="js/kql-highlight.js" defer></script>
    <script src="js/kql-clipboard.js" defer></script>
    <script src="js/collapsible.js" defer></script>
    <script src="js/checklist.js" defer></script>
    <script src="js/navigation.js" defer></script>
    <script src="js/search.js" defer></script>
</body>
</html>